<div class="container">

    <app-alert-display></app-alert-display>

    <div class="row">
        <div class="col">
            <div class="float-right my-2">
                <button class="btn btn-drooltool btn-sm ml-3" (click)="launchModal(addNew)">Add New</button>
            </div>
            <h2 class="d-inline-block my-2">News And Announcements</h2>
        </div>
    </div>
    <!-- <div class="row mt-1 mb-2">
        <div class="col">
            <custom-rich-text [customRichTextTypeID]="richTextTypeID"></custom-rich-text>
        </div>
    </div>
    <div class="row">
        <div class="col-auto mr-auto">
        </div>
        <div class="col-auto">
            <div class="row">
                <div class="col-sm-2 pl-0 mt-1 mb-1">
                    <a class="btn btn-secondary btn-sm" style="cursor: pointer;" (click)="exportToCsv()" placement="top"
                        ngbTooltip="Download list of Withdrawals"><i class="fas fa-download"></i></a>
                </div>
            </div>
        </div>
    </div> -->
</div>
<div class="container">
    <div class="table-responsive">
        <ag-grid-angular #newsAndAnnouncementsGrid style="width: 100%; height: 400px;" class="ag-theme-balham"
            [rowData]="newsAndAnnouncements" [columnDefs]="columnDefs" [pagination]="true" [paginationPageSize]="100">
        </ag-grid-angular>
    </div>
</div>
<ng-template #addNew let-modal>
    <form [formGroup]="myForm" (ngSubmit)="onSubmit()">
        <div class="modal-header">
            <h4 class="modal-title" id="addNewModalTitle">Add New</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="title">Title</label>
                <input 
                    formControlName="title"
                    id="title" 
                    type="text" 
                    class="form-control"
                    required>
                <div *ngIf="f.title.touched && f.title.invalid" class="alert alert-danger">
                    <div *ngIf="f.title.errors.required">Title is required.</div>
                </div>
            </div>
            <div class="form-group">
                <label for="date">Date</label>
                <div class="input-group">
                    <input 
                    formControlName="date"
                    id="date" 
                    type="text" 
                    ngbDatepicker #d="ngbDatepicker"
                    placeholder="yyyy-mm-dd"
                    (click)="d.toggle()"
                    class="form-control">
                    <div class="input-group-append">
                        <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"><i class="fa fa-calendar" aria-hidden="true"></i></button>
                      </div>
                </div>
                              
                <div *ngIf="f.date.touched && f.date.invalid" class="alert alert-danger">
                    <div *ngIf="f.date.errors.required">Date is required.</div>
                    <!-- <div *ngIf="f.date.errors.pattern">Date must be in the format 'yyyy-mm-dd'</div> -->
                </div>
            </div>   
            <div class="form-group">
                <label for="link">Link</label>
                <input 
                    formControlName="link"
                    id="link" 
                    type="text" 
                    class="form-control"
                    >
            </div>        
            <div class="form-group">
                <label for="image">Image</label>
                <input 
                    formControlName="image"
                    id="image" 
                    type="file" 
                    class="form-control"
                    (change)="onFileChange($event)">
                <div *ngIf="f.image.touched && f.image.invalid" class="alert alert-danger">
                    <div *ngIf="f.image.errors.required">File is required.</div>
                </div>
            </div>
            
            <ng-container *ngIf="imageSrc">
                <label>Image Preview</label>
                <img [src]="imageSrc" *ngIf="imageSrc" style="height:auto; width:auto; max-height:350px; max-width:350px">
            </ng-container>
        </div>
        <div class="modal-footer">
            <button type="submit" class="btn btn-drooltool btn-sm"
                [disabled]="isLoadingSubmit">
                <span *ngIf="isLoadingSubmit" class="fa fa-spinner loading-spinner"></span>
                Submit</button>
            <button type="button" class="btn btn-secondary btn-sm" (click)="modal.close('Cancel click')"
                [disabled]="isLoadingSubmit">Cancel</button>
        </div>
    </form>
</ng-template>